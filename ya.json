{
  "Traffic Simulation Setup": {
    "prefix": "setup",
    "body": [
      "const road = document.getElementById(\"road\")",
      "const lightEl = document.getElementById(\"traffic-light\")",
      "const button = document.getElementById(\"button\")",
      "",
      "const ROAD_WIDTH = 600",
      "const ROAD_HEIGHT = 600",
      "const CENTER_X = ROAD_WIDTH / 2",
      "const CENTER_Y = ROAD_HEIGHT / 2",
      "",
      "let cars = []"
    ],
    "description": "Initialize traffic simulation setup with constants and DOM elements"
  },

  "Traffic Light Class": {
    "prefix": "traffic-light-class",
    "body": [
      "class TrafficLight {",
      "  constructor() {",
      "    this.states = ['green', 'yellow', 'red'];",
      "    this.currentIndex = 0;",
      "    this.state = this.states[this.currentIndex];",
      "    this.render();",
      "  }",
      "",
      "  next() {",
      "    this.currentIndex = ",
      "        (this.currentIndex + 1) % this.states.length",
      "    this.state = this.states[this.currentIndex];",
      "    this.render();",
      "  }",
      "",
      "  render() {",
      "    lightEl.style.background = this.state;",
      "  }",
      "}",
      "",
      "const trafficLight = new TrafficLight();",
      "",
      "button.addEventListener(\"click\", () => {",
      "    trafficLight.next();",
      "});",
      "",
      "if (trafficLight.state === \"green\") trafficLight.next();",
      "else if (trafficLight.state === \"yellow\") trafficLight.next();"
    ],
    "description": "Traffic light class with states and button control"
  },

  "Car Class": {
    "prefix": "car-class",
    "body": [
      "class Car {",
      "    constructor(x, y, direction = \"up\") {",
      "        this.x = x;",
      "        this.y = y;",
      "        this.direction = direction;",
      "        this.length = 40; // or whatever fits your car div",
      "",
      "        this.speed = 0;",
      "        this.maxSpeed = 2;",
      "        this.acceleration = 0.05;",
      "",
      "        this.el = document.createElement(\"div\");",
      "        this.el.className = \"car\";",
      "        road.appendChild(this.el);",
      "    }",
      "",
      "    move(cars) {",
      "        const STOP_LINE_Y1 = CENTER_Y - 100;",
      "        const STOP_LINE_X1 = CENTER_X - 100;",
      "        const STOP_LINE_Y2 = CENTER_Y + 100;",
      "        const STOP_LINE_X2 = CENTER_X + 100;",
      "",
      "        if (trafficLight.state === \"red\") {",
      "",
      "        /* ðŸš— UP */",
      "        if (this.direction === \"up\") {",
      "            const front = this.y;",
      "",
      "            if (front <= STOP_LINE_Y2) {",
      "            this.speed = 0;",
      "            this.y = STOP_LINE_Y2;",
      "            this.render();",
      "            return;",
      "            }",
      "        }",
      "",
      "        /* ðŸš— DOWN */",
      "        if (this.direction === \"down\") {",
      "            const front = this.y + this.length;",
      "",
      "            if (front >= STOP_LINE_Y1) {",
      "            this.speed = 0;",
      "            this.y = STOP_LINE_Y1 - this.length;",
      "            this.render();",
      "            return;",
      "            }",
      "        }",
      "",
      "        /* ðŸš— LEFT */",
      "        if (this.direction === \"left\") {",
      "            const front = this.x;",
      "",
      "            if (front <= STOP_LINE_X2) {",
      "            this.speed = 0;",
      "            this.x = STOP_LINE_X2;",
      "            this.render();",
      "            return;",
      "            }",
      "        }",
      "",
      "        /* ðŸš— RIGHT */",
      "        if (this.direction === \"right\") {",
      "            const front = this.x + this.length;",
      "",
      "            if (front >= STOP_LINE_X1) {",
      "            this.speed = 0;",
      "            this.x = STOP_LINE_X1 - this.length;",
      "            this.render();",
      "            return;",
      "            }",
      "        }",
      "        }",
      "            let nearestCar = null;",
      "",
      "            const isVertical =",
      "            this.direction === \"up\" || this.direction === \"down\";",
      "",
      "            for (let car of cars) {",
      "            if (car === this) continue;",
      "            if (car.direction !== this.direction) continue;",
      "",
      "            // must be in the same lane",
      "            if (isVertical && car.x !== this.x) continue;",
      "            if (!isVertical && car.y !== this.y) continue;",
      "",
      "            const isAhead = isVertical",
      "                ? (this.direction === \"up\"",
      "                    ? car.y < this.y",
      "                    : car.y > this.y)",
      "                : (this.direction === \"left\"",
      "                    ? car.x < this.x",
      "                    : car.x > this.x);",
      "",
      "            if (!isAhead) continue;",
      "",
      "            if (",
      "                !nearestCar ||",
      "                (isVertical",
      "                ? (this.direction === \"up\"",
      "                    ? car.y > nearestCar.y",
      "                    : car.y < nearestCar.y)",
      "                : (this.direction === \"left\"",
      "                    ? car.x > nearestCar.x",
      "                    : car.x < nearestCar.x))",
      "            ) {",
      "                nearestCar = car;",
      "            }",
      "            }",
      "",
      "        if (nearestCar) {",
      "            const distance = isVertical",
      "                ? Math.abs(this.y - nearestCar.y)",
      "                : Math.abs(this.x - nearestCar.x);",
      "                ",
      "            if (distance <= 60) {",
      "                this.speed = 0;",
      "            } else if (distance <= 100) {",
      "                this.speed = Math.max(this.speed - this.acceleration, 0);",
      "            } else {",
      "                this.speed = Math.min(this.speed + this.acceleration, this.maxSpeed);",
      "            }",
      "        } else {",
      "            this.speed = Math.min(this.speed + this.acceleration, this.maxSpeed);",
      "        }",
      "",
      "        this.updatePosition();",
      "        this.render();",
      "    }",
      "",
      "            updatePosition() {",
      "            if (this.direction === \"up\") this.y -= this.speed;",
      "            if (this.direction === \"down\") this.y += this.speed;",
      "            if (this.direction === \"left\") this.x -= this.speed;",
      "            if (this.direction === \"right\") this.x += this.speed;",
      "            }",
      "",
      "            render() {",
      "            let rotation = 0;",
      "",
      "            if (this.direction === \"up\") rotation = -90;",
      "            if (this.direction === \"down\") rotation = 90;",
      "            if (this.direction === \"left\") rotation = 180;",
      "            if (this.direction === \"right\") rotation = 0;",
      "",
      "            this.el.style.transform =",
      "                `translate(${this.x}px, ${this.y}px) rotate(${rotation}deg)`;",
      "            }",
      "",
      "            isOut() {",
      "            if (this.direction === \"up\") return this.y < -80;",
      "            if (this.direction === \"down\") return this.y > 880;",
      "            if (this.direction === \"left\") return this.x < -80;",
      "            if (this.direction === \"right\") return this.x > 880;",
      "            }",
      "",
      "    destroy() {",
      "        this.el.remove();",
      "    }",
      "}"
    ],
    "description": "Car class with movement, collision, and rendering logic"
  },

  "Traffic Simulation Loop": {
    "prefix": "gameloop",
    "body": [
      "const lanes = [",
      "  // vertical lanes",
      "  { x: 260, direction: \"up\" },",
      "  { x: 300, direction: \"down\" },",
      "",
      "  // horizontal lanes",
      "  { y: 240, direction: \"right\" },",
      "  { y: 290, direction: \"left\" }",
      "];",
      "",
      "setInterval(() => {",
      "  const lane = lanes[Math.floor(Math.random() * lanes.length)];",
      "  let x, y;",
      "",
      "  if (lane.direction === \"up\" || lane.direction === \"down\") {",
      "    x = lane.x;",
      "    y = lane.direction === \"up\" ? 800 : -80;",
      "  } else {",
      "    y = lane.y;",
      "    x = lane.direction === \"right\" ? -80 : 800;",
      "  }",
      "",
      "  cars.push(new Car(x, y, lane.direction));",
      "}, 600);",
      "",
      "function gameLoop() {",
      "    cars.forEach((car) => {",
      "        car.move(cars);",
      "    });",
      "",
      "    cars = cars.filter(car => {",
      "        if (car.isOut()) {",
      "            car.destroy();",
      "            return false;",
      "        }",
      "        return true;",
      "    });",
      "",
      "    requestAnimationFrame(gameLoop);",
      "}",
      "",
      "gameLoop();"
    ],
    "description": "Car spawning and main game loop for traffic simulation"
  }
}
